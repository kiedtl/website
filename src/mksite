#!/bin/bash

# ------- EDIT THESE VARIABLES --------
site_name="./kiedtl"
folders=("computers")

# -------- DO NOT EDIT BELOW ----------
name="ariel"
html1='<!DOCTYPE html><html lang=en><head><link href="'
html2="\" rel=icon type=\"image/png\"><title>${site_name}</title><meta name=viewport content=\"width=device-width\"><style>"
html3='</style>'
html4='</head><body><main>{{content}}</main></body></html>'

style='a{background:linear-gradient(to bottom,#cdcdcd,#cdcdcd) 50% calc(100% - 2px)/50% 2px no-repeat;color:#333;margin:-1px;text-decoration:none!important;-webkit-transition:all .35s ease-in-out;transition:all .35s ease-in-out}a:focus,a:hover{background-image:linear-gradient(to bottom,#777,#777);background-size:100% 3px;color:#111;-webkit-transition:all .35s ease-in-out!important;transition:all .35s ease-in-out!important}body{overflow-y:scroll;font-family:sans-serif}img,main{display:block;margin:25px auto}main{padding:20px;max-width:600px;line-height:1.6;word-wrap:break-word}img{max-width:100%}pre>code{display:block;padding:20px;white-space:pre-line}code{background:#eee;padding:2px}blockquote{border-left:7px solid #ddd;padding-left:14px;color:#666;margin:0}h1,h2,h3,h4{line-height:1.2}h1{font-family:monospace}'
favicon='data:image/png;base64,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XnrppYrP7dq1q9cGICsCgOyMHTu2Reebm5uT/B46rbNx48Y4+eSTk8z+zGc+EyNGjEgyG6qNACA7Hv/Xvocffjhuv/32JLNvuumm2G233ZLMhmoiAMhKr1694qijjir7/PLly+ORRx5JuBGtdfbZZyd5X4a+ffvGJZdcUvG5UG0EAFlpamqKhoaGss/PnDkztmzZknAjWuudd96Jc845J8nsM844Iw499NAks6FaCACy0tLH/177v7rddtttSZ7QeG0AcuBPN9no1q1bDBw4sOzz69evj3vvvTfdQlTEySefHJs2bar43E9+8pMxbty4is+FaiEAyMbIkSOjY8eOZZ+/9957k7zPPZW1YMGCuOqqq5LMvuKKK+IP/uAPksyGogkAsuGn/+vXpEmTYuHChRWfu8cee8T1119f8blQDQQAWdh1111j2LBhZZ/fsmVLzJgxI+FGVNKGDRuSvZTvX/7lX7bozw7UCgFAFoYOHdqi3+1+5JFH4t133024EZX24IMPxh133JFk9s033xy77rprktlQFAFAFjz+z8OZZ56ZJNz222+/+Md//MeKz4UiCQDqXocOHWLUqFFlny+VSn79r0YtWbIkzjvvvCSzzzrrrBa9hwRUOwFA3RswYEB079697PNPPPFEvP766wk3IqXvfOc7MXfu3IrP3f7aAC15ISmoZgKAuufxf15KpVKMGzcuNm/eXPHZxxxzTHzlK1+p+FwoggCgrjU0NMSYMWNa9DECoPb9/Oc/j6uvvjrJ7CuvvDL23HPPJLOhLXUoegGq28SJE2Ovvfaq+Nx169bFV7/61YrP/V39+vWL3r17l33+xRdfTPJe87S9iRMnxl/91V/F/vvvX9G53bp1i+uuuy4+97nPVXQutDUBwA79xV/8RRx44IEVn7ty5co2CQCP//O1fv36mDBhQsyePbvisz/72c/Gd7/73bjvvvsqPhvaim8BUNcEQN7uvffeuPPOO5PMnjx5stcGoKYJAOrWQQcdFAcddFDZ5xcvXhxPPvlkwo0owhlnnBErVqyo+Nz9998/vva1r1V8LrQVAUDd8ta/RES89dZbccEFFySZfc4558TBBx+cZDakJgCoWx7/s92UKVNi3rx5FZ/bsWNHrw1AzRIA1KXevXtHv379yj6/bNmymDNnTsKNKNL21wbYsmVLxWf3798/vvSlL1V8LqQmAKhLY8aMadFXZTNmzIitW7cm3IiiPffcc3Httdcmmf2Nb3wjevbsmWQ2pCIAqEse//N+Lr300li0aFHF537oQx9KFheQigCg7nTv3j0GDBhQ9vm1a9f6fe5MrFu3LiZMmJBk9uc///kYMmRIktmQggCg7owaNSo6dCj/Na5mz54dGzZsSLgR1WTWrFlx1113JZk9efLk2GWXXZLMhkoTANQdj//5IKeddlqsWrWq4nMPOOCAuOiiiyo+F1IQANSV3XbbLYYOHVr2+c2bN8c999yTcCOq0ZtvvhkXXnhhktnnnntufOxjH0syGypJAFBXhg0b1qKXZ/3JT36S5FXiqH6TJ0+O//qv/6r43MbGRq8NQE0QANQVj/8p17Zt22LcuHFJfv3zz/7sz+Kkk06q+FyoJAFA3ejYsWOMHDmy7POlUimmTZuWcCOq3TPPPBPXX399ktnf/OY3o0ePHklmQyUIAOrGwIEDo1u3bmWff+yxx+LNN99MuBG14Otf/3q8+uqrFZ/bvXv3uOaaayo+FypFAFA3PP6nNdauXRunnHJKktlf+MIXYtCgQUlmw84SANSFhoaGaGpqatHHCAC2mzFjRrI/D5MnT45OnTolmQ07QwBQF4466qjo1atX2eeff/75ePnllxNuRK059dRTY/Xq1RWf+0d/9EfJfuUQdoYAoC54/M/Oev311+Piiy9OMvv888+PAw88MMlsaC0BQF0QAFTCjTfeGPPnz6/43MbGxrjlllsqPhd2hgCg5n384x+Pj370o2WfX7RoUTz99NMJN6JWpXxtgIEDB8aJJ55Y8bnQWuW/YwpZGjVqVJIfYKrk/8G29Kv/5ubmin3uWvJv//Zv8cADD+z0nDVr1lRgm+o1f/78OOigg5K8qU+9/7ejtggAdmjhwoVFr/CBPP4vz7Jly2LZsmVFr1ET/IAoOfAtAGpa375948gjjyz7/NKlS2Pu3LkJNwKoDQKAmjZmzJgWnZ8+fXps27Yt0TYAtcO3AKhpK1asaNHLrX7/+99PuA1A7RAA1LTbb7+96BUAapJvAQBAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGRIAABAhgQAAGSoqgOgoaGh6BUAoFWq/Q6r6gDo3Llz0SsAQKt06dKl6BV2qKoDoGvXrkWvAACtUu13WFUHwL777lv0CgDQKtV+h1V1ABx44IFFrwAArVLtd1hDqVQqFb3E77Ny5cro0aNHbN68uehVAKBsjY2NsXTp0qr+NkBVPwHYY489YvDgwUWvAQAtMnjw4Kq+/COqPAAiIk444YSiVwCAFqmFu6uqvwUQEfH222/HXnvtFVW+JgBExK9+//+tt96Knj17Fr3KDlX9E4A999wzjj/++KLXAICyjBgxouov/4gaeAIQEfHcc8/FYYcd5ikAAFWtXbt28eyzz8YhhxxS9CofqOqfAEREfOITn4gTTzyx6DUAYIdOPPHEmrj8I2rkCUBExGuvvRYHHHBAbNq0yZMAAKpKQ0NDdOrUKRYuXBi9e/cuep2y1MQTgIiI3r17x9VXX+3yB6DqlEql+OY3v1kzl39EDT0BiPjVf+Bx48bFt7/97aJXAYDf+MpXvhK33HJL1b8D4HvVVABERGzatCmOO+64mDNnTtGrAEAMGDAg7r///mhsbCx6lRapuQCIiFi6dGkMHDgwfv7znxe9CgAZO/jgg+Phhx+OHj16FL1Ki9XMzwC8V48ePWLevHkxcuTIiIiaeuQCQG3bfueMHDky5s2bV5OXf0SNBkDEr95nubm5Oc4991w/GAhAmymVSnHeeedFc3Nz1b/e/47U5LcAftfUqVPj7LPPjkWLFkVDQ4MgAKCitt8t++67b1xzzTUxduzYolfaaTX7BOC9Pv3pT8eCBQviuuuui27duhW9DgB1plu3bnHdddfFggUL6uLyj6iTJwDvtWLFirj55pvjxz/+ccyfP7/odQCoYX/8xzuS/HYAAAEFSURBVH8cY8eOjQkTJtTdF5h1FwDv9eqrr8b06dNj5syZ8dxzz8Ubb7xR9EoAVLFevXrFJz7xiRg5cmQ0NTXFPvvsU/RKydR1APyu1atXx9KlS2P16tWxfv36otcBoArsuuuu0aVLl+jRo0d06dKl6HXaTFYBAAD8Sl38ECAA0DICAAAyJAAAIEMCAAAyJAAAIEMCAAAyJAAAIEMCAAAyJAAAIEMCAAAyJAAAIEMCAAAyJAAAIEMCAAAyJAAAIEMCAAAyJAAAIEMCAAAyJAAAIEMCAAAyJAAAIEMCAAAyJAAAIEMCAAAyJAAAIEMCAAAyJAAAIEMCAAAyJAAAIEMCAAAy9P8A/mqO2io/+E8AAAAASUVORK5CYII='
invisitext='<link rel="stylesheet" href="http://invisi-text.surge.sh/cdn/production/0.2.0/invisi-text.min.css" />'

template="${html1}${favicon}${html2}${style}${html3}${invisitext}${html4}"

if [[ -z $1 ]]; then
    rm -rf _website
    printf "[${name}] cleaning out _website/*\n"
fi

mkdir -p _website/images
mkdir -p _website/blog

for md in _content/*.md; do
    file_name=${md##*/}
    printf "[${name}] processing markdown file ${md}\n"

    [[ $file_name != index.md ]] &&
        home="<a href='/'>Home</a>"


    minify --type html \
        <<< "${template/'{{content}}'/${home}$(pandoc "$md")}" \
        > "_website/${file_name/%.md/.html}"

    home=
done

for folder in $folders; do 
    if [[ ! -d "_website/$folder" ]]; then
        mkdir -p "_website/$folder"
    fi
    
    for md in _content/$folder/*.md; do
        file_name=${md##*/}
        printf "[${name}] processing markdown file ${md} in directory ${folder}\n"

        home="<a href='/'>Home</a>"

        minify --type html \
            <<< "${template/'{{content}}'/${home}$(pandoc "$md")}" \
            > "_website/$folder/${file_name/%.md/.html}"

        home=
    done
done

for md in _content/_posts/*.md; do
    file_name=${md##*/}
    printf "[${name}] processing markdown post ${md}\n"

    home="<a href='/'>Home</a>"

    minify --type html \
        <<< "${template/'{{content}}'/${home}$(pandoc "$md")}" \
        > "_website/blog/${file_name/%.md/.html}"

    home=
done


[[ $1 ]] &&
    exit

cd _website/images || exit

png_flags=(--speed 1 --skip-if-larger --strip -f --verbose --output)

for img in ../../_content/_images/*.{jpg,png}; do (
    file_name=${img##*/}
    suffix=${file_name/*.}
    
    printf "[${name}] processing image ${img}\n"
    x2=${file_name/%.${suffix}/-2x.${suffix}}

    convert "$img" -resize 600x\>  "$file_name"
    convert "$img" -resize 1200x\> "$x2"

    case $suffix in
        jpg) jpegoptim -s "$file_name" "$x2" ;;
        png)
            pngquant "$file_name" "${png_flags[@]}" "$file_name"
            pngquant "$x2" "${png_flags[@]}" "$x2"
        ;;
    esac

    img2webp -lossy -q 90 "$file_name" -o "${file_name%.${suffix}}.webp"
    img2webp -lossy -q 90 "$x2" -o "${x2%.${suffix}}.webp"
) & done

cd ../..

for file in _content/_files/*; do (
  printf "[${name}] moving static file $file to _site/\n"
  cp -r "$file" _website/
) & done

wait
